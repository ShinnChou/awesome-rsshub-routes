<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Awesome RSSHub Routes - ç²¾é€‰ RSS è®¢é˜…æº</title>
  <meta name="description" content="ç²¾é€‰ RSSHub å®ç”¨è·¯ç”±æ¨èï¼Œè®©ä½ çš„ RSS é˜…è¯»æ›´é«˜æ•ˆï¼">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    .feed-card {
      transition: all 0.2s ease;
    }
    .feed-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }
    .category-btn.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    .copy-btn:active {
      transform: scale(0.95);
    }
    .toast {
      animation: slideIn 0.3s ease, fadeOut 0.3s ease 1.7s;
    }
    @keyframes slideIn {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    .gradient-text {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Header -->
  <header class="bg-white shadow-sm sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div class="flex items-center gap-3">
          <span class="text-3xl">ğŸ¯</span>
          <div>
            <h1 class="text-xl font-bold gradient-text">Awesome RSSHub Routes</h1>
            <p class="text-sm text-gray-500" data-i18n="subtitle">ç²¾é€‰ RSS è®¢é˜…æºï¼Œè®©é˜…è¯»æ›´é«˜æ•ˆ</p>
          </div>
        </div>
        <div class="flex items-center gap-3">
          <button id="lang-toggle" onclick="toggleLang()"
                  class="px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-gray-200 transition"
                  title="Switch Language">
            EN
          </button>
          <a href="https://github.com/JackyST0/awesome-rsshub-routes" target="_blank" 
             class="flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-700 transition">
            <i class="fab fa-github"></i>
            <span class="hidden sm:inline">GitHub</span>
          </a>
          <a href="feeds.opml" download 
             class="flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:opacity-90 transition">
            <i class="fas fa-download"></i>
            <span data-i18n="download">ä¸‹è½½ OPML</span>
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8">
    <!-- Stats -->
    <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6">
      <div class="bg-white rounded-xl p-4 shadow-sm text-center">
        <div class="text-2xl font-bold text-indigo-600" id="total-feeds">0</div>
        <div class="text-sm text-gray-500" data-i18n="totalFeeds">è®¢é˜…æºæ€»æ•°</div>
      </div>
      <div class="bg-white rounded-xl p-4 shadow-sm text-center">
        <div class="text-2xl font-bold text-purple-600" id="total-categories">0</div>
        <div class="text-sm text-gray-500" data-i18n="categories">åˆ†ç±»æ•°é‡</div>
      </div>
      <div class="bg-white rounded-xl p-4 shadow-sm text-center">
        <div class="text-2xl font-bold text-green-600" id="valid-feeds">-</div>
        <div class="text-sm text-gray-500" data-i18n="available">å¯ç”¨è®¢é˜…</div>
      </div>
      <div class="bg-white rounded-xl p-4 shadow-sm text-center">
        <div class="text-2xl font-bold text-blue-600" id="success-rate">-</div>
        <div class="text-sm text-gray-500" data-i18n="successRate">æˆåŠŸç‡</div>
      </div>
    </div>

    <!-- Search & Filter -->
    <div class="bg-white rounded-xl p-4 shadow-sm mb-6">
      <!-- Search -->
      <div class="relative mb-4">
        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
        <input type="text" id="search-input" data-i18n-placeholder="searchPlaceholder" placeholder="æœç´¢è®¢é˜…æºåç§°æˆ–é“¾æ¥..." 
               class="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none text-gray-900 bg-white text-base">
      </div>
      <!-- Category Filters -->
      <div class="flex gap-2 overflow-x-auto pb-2" id="category-filters">
        <button class="category-btn active px-4 py-2 rounded-lg bg-gray-100 text-sm whitespace-nowrap transition" data-category="all" onclick="filterByCategory('all')">
          <span data-i18n="all">å…¨éƒ¨</span>
        </button>
      </div>
    </div>

    <!-- Feed Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="feeds-grid">
      <!-- Feeds will be inserted here -->
    </div>

    <!-- Empty State -->
    <div id="empty-state" class="hidden text-center py-12">
      <i class="fas fa-search text-4xl text-gray-300 mb-4"></i>
      <p class="text-gray-500" data-i18n="noResults">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è®¢é˜…æº</p>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-white border-t mt-12">
    <div class="max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8">
      <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
        <p class="text-sm text-gray-500">
          Made with â¤ï¸ by <a href="https://github.com/JackyST0" class="text-indigo-600 hover:underline">JackyST0</a>
        </p>
        <div class="flex items-center gap-4 text-sm text-gray-500">
          <span id="last-check" data-i18n-prefix="lastCheck">æœ€è¿‘æ£€æµ‹ï¼š-</span>
          <a href="https://github.com/JackyST0/awesome-rsshub-routes/issues" class="text-indigo-600 hover:underline">
            <i class="fas fa-chart-line mr-1"></i><span data-i18n="viewReport">æŸ¥çœ‹çŠ¶æ€æŠ¥å‘Š</span>
          </a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-4 right-4 bg-gray-900 text-white px-4 py-2 rounded-lg shadow-lg hidden">
    <i class="fas fa-check mr-2"></i>
    <span id="toast-message">å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</span>
  </div>

  <script>
    // i18n å­—å…¸
    const i18n = {
      zh: {
        subtitle: 'ç²¾é€‰ RSS è®¢é˜…æºï¼Œè®©é˜…è¯»æ›´é«˜æ•ˆ',
        download: 'ä¸‹è½½ OPML',
        totalFeeds: 'è®¢é˜…æºæ€»æ•°',
        categories: 'åˆ†ç±»æ•°é‡',
        available: 'å¯ç”¨è®¢é˜…',
        successRate: 'æˆåŠŸç‡',
        searchPlaceholder: 'æœç´¢è®¢é˜…æºåç§°æˆ–é“¾æ¥...',
        all: 'å…¨éƒ¨',
        copyUrl: 'å¤åˆ¶é“¾æ¥',
        noResults: 'æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è®¢é˜…æº',
        lastCheck: 'æœ€è¿‘æ£€æµ‹',
        viewReport: 'æŸ¥çœ‹çŠ¶æ€æŠ¥å‘Š',
        copied: 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿',
        loadError: 'åŠ è½½è®¢é˜…æºå¤±è´¥',
        noData: 'æš‚æ— æ£€æµ‹æ•°æ®',
        title: 'Awesome RSSHub Routes - ç²¾é€‰ RSS è®¢é˜…æº'
      },
      en: {
        subtitle: 'Curated RSS feeds for efficient reading',
        download: 'Download OPML',
        totalFeeds: 'Total Feeds',
        categories: 'Categories',
        available: 'Available',
        successRate: 'Success Rate',
        searchPlaceholder: 'Search feeds by name or URL...',
        all: 'All',
        copyUrl: 'Copy URL',
        noResults: 'No matching feeds found',
        lastCheck: 'Last Check',
        viewReport: 'View Status Report',
        copied: 'Copied to clipboard',
        loadError: 'Failed to load feeds',
        noData: 'No check data available',
        title: 'Awesome RSSHub Routes - Curated RSS Feeds'
      }
    };

    // å½“å‰è¯­è¨€
    let currentLang = localStorage.getItem('lang') || 'zh';

    // åˆ‡æ¢è¯­è¨€
    function toggleLang() {
      currentLang = currentLang === 'zh' ? 'en' : 'zh';
      localStorage.setItem('lang', currentLang);
      applyLang();
      renderFeeds(); // é‡æ–°æ¸²æŸ“å¡ç‰‡ä¸Šçš„æŒ‰é’®æ–‡å­—
    }

    // åº”ç”¨è¯­è¨€
    function applyLang() {
      const t = i18n[currentLang];

      // æ›´æ–°é¡µé¢æ ‡é¢˜
      document.title = t.title;
      document.documentElement.lang = currentLang === 'zh' ? 'zh-CN' : 'en';

      // æ›´æ–°åˆ‡æ¢æŒ‰é’®
      document.getElementById('lang-toggle').textContent = currentLang === 'zh' ? 'EN' : 'ä¸­';

      // æ›´æ–°æ‰€æœ‰ data-i18n å…ƒç´ 
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (t[key]) el.textContent = t[key];
      });

      // æ›´æ–° placeholder
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (t[key]) el.placeholder = t[key];
      });

      // æ›´æ–° last-checkï¼ˆä¿ç•™æ—¶é—´éƒ¨åˆ†ï¼‰
      const lastCheckEl = document.getElementById('last-check');
      const checkTime = lastCheckEl.dataset.checkTime || '-';
      lastCheckEl.textContent = `${t.lastCheck}ï¼š${checkTime}`;
    }

    // å…¨å±€æ•°æ®
    let allFeeds = [];
    let categories = [];
    let currentCategory = 'all';
    let searchQuery = '';

    // è§£æ OPML
    async function loadFeeds() {
      try {
        const response = await fetch('feeds.opml');
        const text = await response.text();
        const parser = new DOMParser();
        const xml = parser.parseFromString(text, 'text/xml');
        
        const categoryOutlines = xml.querySelectorAll('body > outline');
        
        categoryOutlines.forEach(cat => {
          const categoryName = cat.getAttribute('text') || cat.getAttribute('title');
          categories.push(categoryName);
          
          const feeds = cat.querySelectorAll('outline[xmlUrl]');
          feeds.forEach(feed => {
            allFeeds.push({
              name: feed.getAttribute('text') || feed.getAttribute('title'),
              url: feed.getAttribute('xmlUrl'),
              category: categoryName
            });
          });
        });

        updateStats();
        renderCategories();
        renderFeeds();
        loadFeedStatus();
      } catch (error) {
        console.error(i18n[currentLang].loadError, error);
      }
    }

    // åŠ è½½æ£€æµ‹çŠ¶æ€
    async function loadFeedStatus() {
      try {
        const response = await fetch('https://raw.githubusercontent.com/JackyST0/awesome-rsshub-routes/main/feed-status.json');
        if (response.ok) {
          const status = await response.json();
          document.getElementById('valid-feeds').textContent = status.valid;
          document.getElementById('success-rate').textContent = status.successRate;
          const lastCheckEl = document.getElementById('last-check');
          lastCheckEl.dataset.checkTime = status.checkTime;
          lastCheckEl.textContent = `${i18n[currentLang].lastCheck}ï¼š${status.checkTime}`;
        }
      } catch (error) {
        console.log(i18n[currentLang].noData);
      }
    }

    // æ›´æ–°ç»Ÿè®¡
    function updateStats() {
      document.getElementById('total-feeds').textContent = allFeeds.length;
      document.getElementById('total-categories').textContent = categories.length;
    }

    // æ¸²æŸ“åˆ†ç±»æŒ‰é’®
    function renderCategories() {
      const container = document.getElementById('category-filters');
      categories.forEach(cat => {
        const btn = document.createElement('button');
        btn.className = 'category-btn px-4 py-2 rounded-lg bg-gray-100 text-sm whitespace-nowrap transition';
        btn.dataset.category = cat;
        btn.textContent = cat.replace(/^[^\s]+\s/, ''); // å»æ‰ emoji
        btn.onclick = () => filterByCategory(cat);
        container.appendChild(btn);
      });
    }

    // æ¸²æŸ“è®¢é˜…æºå¡ç‰‡
    function renderFeeds() {
      const container = document.getElementById('feeds-grid');
      const emptyState = document.getElementById('empty-state');
      const t = i18n[currentLang];
      
      let filteredFeeds = allFeeds;
      
      // æŒ‰åˆ†ç±»ç­›é€‰
      if (currentCategory !== 'all') {
        filteredFeeds = filteredFeeds.filter(f => f.category === currentCategory);
      }
      
      // æŒ‰æœç´¢è¯ç­›é€‰
      if (searchQuery) {
        const query = searchQuery.toLowerCase();
        filteredFeeds = filteredFeeds.filter(f => 
          f.name.toLowerCase().includes(query) || 
          f.url.toLowerCase().includes(query) ||
          f.category.toLowerCase().includes(query)
        );
      }

      if (filteredFeeds.length === 0) {
        container.innerHTML = '';
        emptyState.classList.remove('hidden');
        return;
      }

      emptyState.classList.add('hidden');
      
      container.innerHTML = filteredFeeds.map(feed => `
        <div class="feed-card bg-white rounded-xl p-4 shadow-sm border border-gray-100">
          <div class="flex items-start justify-between gap-2 mb-2">
            <h3 class="font-medium text-gray-900 flex-1">${escapeHtml(feed.name)}</h3>
            <span class="text-xs px-2 py-1 bg-indigo-50 text-indigo-600 rounded-full whitespace-nowrap">
              ${escapeHtml(feed.category.replace(/^[^\s]+\s/, ''))}
            </span>
          </div>
          <p class="text-xs text-gray-400 truncate mb-3" title="${escapeHtml(feed.url)}">${escapeHtml(feed.url)}</p>
          <div class="flex gap-2">
            <button onclick="copyUrl('${escapeHtml(feed.url)}')" 
                    class="copy-btn flex-1 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm transition">
              <i class="fas fa-copy mr-1"></i>${t.copyUrl}
            </button>
            <a href="${escapeHtml(feed.url)}" target="_blank" 
               class="px-3 py-1.5 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 rounded-lg text-sm transition">
              <i class="fas fa-external-link-alt"></i>
            </a>
          </div>
        </div>
      `).join('');
    }

    // åˆ†ç±»ç­›é€‰
    function filterByCategory(category) {
      currentCategory = category;
      
      // æ›´æ–°æŒ‰é’®çŠ¶æ€
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.category === category);
      });
      
      renderFeeds();
    }

    // å¤åˆ¶é“¾æ¥
    function copyUrl(url) {
      navigator.clipboard.writeText(url).then(() => {
        showToast(i18n[currentLang].copied);
      });
    }

    // æ˜¾ç¤ºæç¤º
    function showToast(message) {
      const toast = document.getElementById('toast');
      document.getElementById('toast-message').textContent = message;
      toast.classList.remove('hidden');
      setTimeout(() => toast.classList.add('hidden'), 2000);
    }

    // HTML è½¬ä¹‰
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // æœç´¢
    document.getElementById('search-input').addEventListener('input', (e) => {
      searchQuery = e.target.value;
      renderFeeds();
    });

    // åˆå§‹åŒ–
    applyLang();
    loadFeeds();
  </script>
</body>
</html>
